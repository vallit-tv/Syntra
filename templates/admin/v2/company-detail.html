{% extends "admin/v2/base.html" %}

{% block title %}Company Detail â€“ Syntra{% endblock %}

{% block breadcrumbs %}
<div class="breadcrumb-item">
    <i data-lucide="shield" width="14" height="14"></i>
    <a href="{{ url_for('admin_dashboard') }}" class="breadcrumb-link">Admin</a>
</div>
<span class="breadcrumb-separator">/</span>
<div class="breadcrumb-item">
    <a href="{{ url_for('admin_companies') }}" class="breadcrumb-link">Companies</a>
</div>
<span class="breadcrumb-separator">/</span>
<div class="breadcrumb-item">
    <span>{{ company.name }}</span>
</div>
{% endblock %}

{% block content %}
<div class="page-header">
    <div>
        <h1 class="page-title">{{ company.name }}</h1>
        <p class="page-subtitle">{{ company.slug }}</p>
    </div>
    <div class="d-flex gap-2">
        <a href="{{ url_for('admin_access_company', company_id=company.id) }}" class="btn btn-secondary">
            <i data-lucide="eye" width="16"></i>
            View Dashboard
        </a>
    </div>
</div>

<div class="stats-grid mb-6">
    <div class="stat-card">
        <span class="stat-label">Total Users</span>
        <div class="stat-value">{{ user_stats.total }}</div>
    </div>
    <div class="stat-card">
        <span class="stat-label">Active Workflows</span>
        <div class="stat-value">{{ activation_stats.active }}</div>
    </div>
    <div class="stat-card">
        <span class="stat-label">Total Executions</span>
        <div class="stat-value">{{ activation_stats.execution_count }}</div>
    </div>
</div>

<div class="card mb-6">
    <div class="card-header">
        <h3 class="card-title">Team Members</h3>
    </div>
    <div class="table-wrapper border-0 radius-lg">
        <table class="table">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Role</th>
                    <th>Email</th>
                </tr>
            </thead>
            <tbody>
                {% if members %}
                {% for m in members %}
                <tr>
                    <td class="font-medium">{{ m.name }}</td>
                    <td>
                        <span class="badge badge-neutral">{{ m.role|default('user') }}</span>
                    </td>
                    <td class="text-secondary">{{ m.email }}</td>
                </tr>
                {% endfor %}
                {% else %}
                <tr>
                    <td colspan="3" class="text-center p-4">No team members</td>
                </tr>
                {% endif %}
            </tbody>
        </table>
    </div>
</div>

<div class="card">
    <div class="card-header">
        <h3 class="card-title">Activations</h3>
    </div>
    <div class="table-wrapper border-0 radius-lg">
        <table class="table">
            <thead>
                <tr>
                    <th>Workflow</th>
                    <th>Status</th>
                    <th>Last Run</th>
                </tr>
            </thead>
            <tbody>
                {% if activations %}
                {% for act in activations %}
                <tr>
                    <td class="font-medium">{{ act.workflow_name|default(act.workflow_id) }}</td>
                    <td>
                        {% if act.is_active %}
                        <span class="badge badge-success">Active</span>
                        {% else %}
                        <span class="badge badge-neutral">Inactive</span>
                        {% endif %}
                    </td>
                    <td class="text-secondary">{{ act.last_executed_at|format_datetime('relative') if
                        act.last_executed_at else 'Never' }}</td>
                </tr>
                {% endfor %}
                {% else %}
                <tr>
                    <td colspan="3" class="text-center p-4">No activations</td>
                </tr>
                {% endif %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}