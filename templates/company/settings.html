{% extends "company/base.html" %}

{% block breadcrumbs %}
<span>Settings</span>
{% endblock %}

{% block company_content %}
<div class="page-header">
    <h1 class="page-title">Company Settings</h1>
    <p class="page-description">Manage your company information and preferences.</p>
</div>

<div class="dashboard-card">
    <div class="card-header">
        <h2 class="card-title">Company Information</h2>
    </div>
    <div class="card-body">
        <form id="companySettingsForm">
            <div class="form-group">
                <label for="companyName" class="form-label">Company Name</label>
                <input type="text" id="companyName" name="name" class="form-input" value="{{ company.name }}" required>
            </div>
            <div class="form-group">
                <label for="companySlug" class="form-label">Company Slug</label>
                <input type="text" id="companySlug" name="slug" class="form-input" value="{{ company.slug }}" disabled>
                <p class="form-help-text">The company slug cannot be changed.</p>
            </div>
            <button type="submit" class="btn btn-primary">Save Changes</button>
        </form>
    </div>
</div>

<div class="dashboard-card">
    <div class="card-header">
        <h2 class="card-title">Account</h2>
    </div>
    <div class="card-body">
        <div class="detail-item">
            <strong>Your Name:</strong> {{ user.name }}
        </div>
        <div class="detail-item">
            <strong>Your Role:</strong> <span class="status-badge active">CEO</span>
        </div>
        <div class="detail-item">
            <strong>Company ID:</strong> {{ company.id }}
        </div>
    </div>
</div>
{% endblock %}

{% block company_scripts %}
<script>
document.getElementById('companySettingsForm').addEventListener('submit', function(event) {
    event.preventDefault();
    const name = document.getElementById('companyName').value;

    fetch('/api/company/settings', {
        method: 'PUT',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ name })
    })
    .then(response => response.json())
    .then(data => {
        if (data.error) {
            alert('Error updating settings: ' + data.error);
        } else {
            alert('Settings updated successfully!');
            location.reload();
        }
    })
    .catch(err => alert('Error: ' + err));
});

lucide.createIcons();
</script>
{% endblock %}

